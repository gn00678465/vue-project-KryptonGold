(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4b543eb5"],{"0dd1":function(t,a,n){"use strict";var o=n("1008"),s=n.n(o);s.a},1008:function(t,a,n){},"9ff0":function(t,a,n){"use strict";n.r(a);var o=function(){var t=this,a=t.$createElement,n=t._self._c||a;return n("div",{staticClass:"container-fluid vld-parent"},[n("loading",{attrs:{active:t.isLoading,"can-cancel":!0,"background-color":"#555","is-full-page":!0},on:{"update:active":function(a){t.isLoading=a}}},[n("LoadEffect",{attrs:{slot:"default"},slot:"default"})],1),n("div",{staticClass:"row"},[n("div",{staticClass:"col"},[n("div",{staticClass:"dashboard"},[n("header",{staticClass:"header"},[n("div",{staticClass:"title"},[t._v("優惠卷管理列表")]),n("BtnGroup",{staticClass:"newBtn",attrs:{btns:t.btn},on:{"btn-emit":t.BtnClick}})],1),n("main",{staticClass:"body"},[n("div",{staticClass:"table"},[n("div",{staticClass:"table-head"},[n("div",{staticClass:"tr"},[n("span",{staticClass:"th"},[t._v("優惠卷名稱")]),n("span",{staticClass:"th"},[t._v("優惠碼")]),n("span",{staticClass:"th"},[t._v("折扣(%)")]),n("span",{staticClass:"th"},[t._v("到期日")]),n("span",{staticClass:"th"},[t._v("是否啟用")]),n("span",{staticClass:"th"},[n("font-awesome-icon",{staticClass:"icon",attrs:{icon:["fas","user-cog"]}})],1)])]),n("div",{directives:[{name:"scrollbar",rawName:"v-scrollbar"}],staticClass:"table-body"},t._l(t.coupons,(function(t){return n("item",{key:t.id,attrs:{coupon:t}})})),1)]),n("pagination",{attrs:{total_pages:t.total,page:t.page},on:{"update:page":function(a){t.page=a}}})],1)])])]),n("Modal",{ref:"modal",on:{modalEmit:t.newCoupon}})],1)},s=[],e=(n("d3b7"),function(){var t=this,a=t.$createElement,n=t._self._c||a;return n("div",{staticClass:"tr vld-parent"},[n("loading",{attrs:{active:t.isLoading,color:"#218DFE","can-cancel":!0,loader:"dots","is-full-page":!1},on:{"update:active":function(a){t.isLoading=a}}}),n("span",{staticClass:"td"},[t._v(t._s(t.coupon.title))]),n("span",{staticClass:"td"},[t._v(t._s(t.coupon.code))]),n("span",{staticClass:"td"},[t._v(t._s(t._f("Percent")(t.coupon.percent)))]),n("span",{staticClass:"td"},[t._v(t._s(t.coupon.deadline.datetime))]),n("span",{staticClass:"td"},[n("toggle",{attrs:{prodId:t.coupon.id.substr(0,5),disabled:!0,checked:t.coupon.enabled}})],1),n("span",{staticClass:"td"},[n("BtnGroup",{attrs:{btns:t.btns,border:!0,btnSize:"md"},on:{"btn-emit":t.BtnClick}})],1),n("Modal",{ref:"modal",on:{modalEmit:t.edit}}),n("Dialog",{ref:"dialog",on:{dialog:t.confirm}},[t._v("刪除此優惠卷?")])],1)}),i=[];n("ac1f"),n("1276");function c(t){if(Array.isArray(t))return t}n("a4d3"),n("e01a"),n("d28b"),n("3ca3"),n("ddb0");function d(t,a){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t)){var n=[],o=!0,s=!1,e=void 0;try{for(var i,c=t[Symbol.iterator]();!(o=(i=c.next()).done);o=!0)if(n.push(i.value),a&&n.length===a)break}catch(d){s=!0,e=d}finally{try{o||null==c["return"]||c["return"]()}finally{if(s)throw e}}return n}}var r=n("06c5");function l(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function u(t,a){return c(t)||d(t,a)||Object(r["a"])(t,a)||l()}var p=n("5530"),h=(n("99af"),{methods:{getCouponsList:function(t){var a=this;this.isLoading=!0,this.$http.get("".concat("https://course-ec-api.hexschool.io/api/").concat("99034dfb-2d10-45b5-8844-dd3e163815eb","/admin/ec/coupons?page=").concat(t,"&paged=10")).then((function(t){200===t.status&&(a.coupons=t.data.data,a.total=t.data.meta.pagination.total_pages,a.isLoading=!1)})).catch((function(t){a.isLoading=!1,a.$toast.error(t.response.data.message)}))},createCoupon:function(t){var a=this;this.isLoading=!0,this.$http.post("".concat("https://course-ec-api.hexschool.io/api/").concat("99034dfb-2d10-45b5-8844-dd3e163815eb","/admin/ec/coupon"),t).then((function(t){200===t.status&&(a.$toast.success("優惠券新增成功"),a.getCouponsList())})).catch((function(t){a.isLoading=!1,a.$toast.error(t.response.data.message)}))},updateCoupon:function(t){var a=this;this.isLoading=!0,this.$http.patch("".concat("https://course-ec-api.hexschool.io/api/").concat("99034dfb-2d10-45b5-8844-dd3e163815eb","/admin/ec/coupon/").concat(t.id),t).then((function(t){200===t.status&&(a.isLoading=!1,a.$toast.success("編輯優惠券成功"),a.$parent.getCouponsList())})).catch((function(t){a.isLoading=!1,a.$toast.error(t.response.data.message)}))},destroyCoupon:function(t){var a=this;this.isLoading=!0,this.$http.delete("".concat("https://course-ec-api.hexschool.io/api/").concat("99034dfb-2d10-45b5-8844-dd3e163815eb","/admin/ec/coupon/").concat(t)).then((function(t){200===t.status&&(a.isLoading=!1,a.$toast.success("優惠卷刪除成功"),a.$parent.getCouponsList())})).catch((function(t){a.isLoading=!1,a.$toast.error(t.response.data.message)}))}}}),f={name:"CouponItem",mixins:[h],components:{Modal:function(){return n.e("chunk-3e38a0cf").then(n.bind(null,"1e2f"))}},props:{coupon:{type:Object,required:!0}},data:function(){return{isLoading:!1,btns:[{class:"info",outline:!0,content:"",icon:"marker",action:"edit"},{class:"error",outline:!0,content:"",icon:"trash-alt",action:"del"}]}},methods:{BtnClick:function(t){this["".concat(t,"Handler")]()},editHandler:function(){this.$refs.modal.ModalShow=!0,this.$refs.modal.ModalTitle="編輯優惠卷",this.$refs.modal.inputTemp=Object(p["a"])({},this.coupon);var t=this.coupon.deadline.datetime.split(" "),a=u(t,2),n=a[0],o=a[1];this.$refs.modal.due_date=n,this.$refs.modal.due_time=o},edit:function(t){this.updateCoupon(t)},delHandler:function(){this.$refs.dialog.isVisible=!0},confirm:function(){this.destroyCoupon(this.coupon.id)}}},b=f,m=(n("0dd1"),n("2877")),g=Object(m["a"])(b,e,i,!1,null,"51c49386",null),v=g.exports,C={name:"Coupons",mixins:[h],components:{item:v,Modal:function(){return n.e("chunk-3e38a0cf").then(n.bind(null,"1e2f"))}},data:function(){return{isLoading:!1,page:1,total:1,coupons:[],btn:[{class:"primary",outline:!1,content:"新增優惠卷",icon:"",action:"new",size:"xl"}]}},created:function(){this.getCouponsList(this.page)},methods:{BtnClick:function(t){this["".concat(t,"Handler")]()},newHandler:function(){this.$refs.modal.ModalShow=!0,this.$refs.modal.ModalTitle="新增優惠卷"},newCoupon:function(t){this.createCoupon(t)}},watch:{page:function(){this.getCouponsList(this.page)}}},_=C,L=(n("aa23"),Object(m["a"])(_,o,s,!1,null,"380d2e77",null));a["default"]=L.exports},aa23:function(t,a,n){"use strict";var o=n("e260b"),s=n.n(o);s.a},e260b:function(t,a,n){}}]);
//# sourceMappingURL=chunk-4b543eb5.fb2217cb.js.map